---
title: 'Summary: Comparative analysis of different parameters between sexual and asexual
  species of Chalcidoidea'
output: pdf_document
---

```{r setup, include=FALSE}
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual")
manual_processed <-read.table("manual_processed_data.csv", header = T, sep= ",")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto")
auto_processed <-read.table("auto_processed_data.csv", header = T, sep= ",")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory")
manual_processed <-manual_processed[complete.cases(manual_processed[,1:4]),]
auto_processed <-auto_processed[complete.cases(auto_processed[,1:4]),]
```



# Species used for comparisons:

## Manual dataset:

* In total: `r length(manual_processed$species[manual_processed$mode!="both"])` species (`r length(manual_processed$species[manual_processed$mode=='asex'])` asexual, `r length(manual_processed$species[manual_processed$mode=='sex'])` sexual)
* Reparted into `r length(levels(factor(manual_processed$pair)))-1` pairs.

Family|Genus|Asex|Sex|Total
------|-----|----------|----|----
Aphelinidae|Aphelinus|2|9|11
||Aphytis|20|35|55
||Encarsia|7|8|15
||Eretmocerus|2|3|5
Torymidae|Megastigmus|7|11|18
||Torymus|1|2|3
Trichogrammatidae|Megaphragma|1|1|2
||Trichogramma|10|12|22
||Trichogrammatoidea|0|2|2

Comparison groups inferred based on either morphological or genetic data:

Genus|Morphologically inferred|Genetically inferred|% genetically inferred
-----|------------------------|--------------------|----------------------
Aphelinus|4|7|64%
Aphytis|41|14|25%
Encarsia|0|16|100%
Eretmocerus|0|5|100%
Megastigmus|0|18|100%
Torymus|3|0|0%
Megaphragma|2|0|0%
Trichogramma|0|22|100%
Trichogrammatoidea|0|2|100%



## Automated dataset:

* In total: `r length(auto_processed$species)` species (`r length(auto_processed$species[auto_processed$mode=='asex'])` asexual, `r length(auto_processed$species[auto_processed$mode=='sex'])` sexual) from `r length(levels(auto_processed$genus))` genera in `r length(levels(auto_processed$family))` families.
* No pairs, using genera instead.

\newpage

```{r echo=F,results='asis',error=F,warning=F}
library('knitr')
family_show <-c()
asex_show <- c()
sex_show <- c()
prop_show <- c()
for(f in levels(auto_processed$family))
{
  family_show <- append(family_show,as.character(auto_processed$family[auto_processed$family==f][1]))
  tmp_asex <- length(auto_processed$species[auto_processed$family==f & auto_processed$mode=="asex"])
  asex_show <- append(asex_show, tmp_asex)
  tmp_sex <- length(auto_processed$species[auto_processed$family==f & auto_processed$mode=="sex"])
  sex_show <- append(sex_show,tmp_sex)
}
auto_show <- data.frame(Family=family_show, Asexual=asex_show, Sexual=sex_show, Total=asex_show+sex_show)
auto_show <- auto_show[with(auto_show, order(Family)),]

kable(auto_show, format = "markdown",row.names = FALSE)

```

```{r echo=F,results='asis',error=F,warning=F}
library('knitr')
family_show <-c()
asex_show <- c()
sex_show <- c()
prop_show <- c()
for(g in levels(auto_processed$genus))
{
  family_show <- append(family_show,as.character(auto_processed$family[auto_processed$genus==g][1]))
  tmp_asex <- length(auto_processed$species[auto_processed$genus==g & auto_processed$mode=="asex"])
  asex_show <- append(asex_show, tmp_asex)
  tmp_sex <- length(auto_processed$species[auto_processed$genus==g & auto_processed$mode=="sex"])
  sex_show <- append(sex_show,tmp_sex)
  prop_show <- append(prop_show, paste0(round((tmp_asex/(tmp_asex+tmp_sex))*100,2),"%"))
}
genus_show <-levels(auto_processed$genus)
auto_show <- data.frame(Family=family_show,Genus=genus_show, Sexual=sex_show, Asexual=asex_show, "Percentage of asexuals" = prop_show)
auto_show <- auto_show[with(auto_show, order(Family, Genus)), ]

kable(auto_show, format = "markdown",row.names = FALSE)

```

## First impressions:
* No effect on body length.
* Seems to have an effect on number of host species.

## Notes
* Some of the species are not in a relation group yet, either because they have both reproduction modes, or because there was no "hard proof" that they were related to any other species
* Species from the Trichogrammatoidea familly are clustered with other species of the Trichogramma family because they were really closely related on ITS2 phylogenies.

## Variables analysed:

__Geographical distribution__: Locations at which species were sampled have been extracted from the nhm database. Used an automatic script to compute the geographical center of each location.  Locations are in latitude; longitude decimal format.

__Number of locations__: Number of different locations at which species were sampled.

__Reproduction mode__: Coded as sexual, asexual, or both. Both means there are sexual and asexual populations in a given species. These species are excluded from analyses.

__Body length__: The length of the body, excluding the ovipositor. Accuracy of the values varies between authors. Min and Max known values are stored when a range is given. If a single value is given, Min and Max are the same. Values are given in milimeters.

__Biogeographic regions__: [indcative, temporary] World was divided in 7 biogeographic regions and species presence was recorded in a binary fashion.

__Extreme coordinates__: Max and Min longitude and latitude at which each species has been encountered. These values were extracted from the geographical distribution, meaning they do not represent exact values, but rather geographical center of the most accurate definition of the sampling site.

__Number of host species__: Overall number of host species for a given wasp species.

__Host orders/families__: Host range recorded in a binary fashion, hosts orders are given except when an order is especially relevant, in which case families are given.

__Development time__: Time from oviposition to emergence of adult. This data is indicative and should be used with care since experimental conditions (i.e. Temperature, day/night cycles, host species, host age, humidity) strongly affect results. Values are given in days.

__Ecology__: Encoded as parasitoid or phytophagous. This value is roughly estimated per genus in the automated dataset, but is more accurately determined in the manual dataset.

## Analyses performed

__Overall:__ These analyses include all species independantly of their genera or families. They are not very informative since the effect of reproduction is masked by the inter-family difference.


__Within Family:__
Same, Inter-genus difference might hide the effect of reproduction mode.


__Within genus:__
More accurate, but some species might still be quite distant. This is the most accurate analysis that can be performed with the automated dataset.

__Per comparison group:__
Only comparing species that are known to be closely related, either on the basis of morphological studies, or phylogenetics studies (Generally CO1 or 18S / 28S rDNA). This is the most accurate analysis performed and is only available with the manual dataset.
