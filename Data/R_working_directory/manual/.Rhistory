library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("MCMCglmm");library("blmeco")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & !is.na(mydf$nbr_country) & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
max_dist_eq <- pmax(abs(mydf$lat_min),abs(mydf$lat_max))
mydf <- cbind(mydf,max_dist_eq)
#generating response variable
par(mfrow=c(2,2))
nbinom <- fitdistr(mydf$max_dist_eq[!is.na(mydf$max_dist_eq)], "Negative Binomial")
gamma <- fitdistr(mydf$max_dist_eq, "Gamma")
qqp(main="Gamma",mydf$max_dist_eq, "gamma", shape = gamma$estimate[[1]], rate = gamma$estimate[[2]])
qqp(main="Lognormal", mydf$max_dist_eq,"lnorm")
qqp(main="Normal", mydf$max_dist_eq,"norm")
poisson <- fitdistr(mydf$max_dist_eq[!is.na(mydf$max_dist_eq)], "Poisson")
qqp(main="Poisson",mydf$max_dist_eq, "pois", poisson$estimate)
densityplot(mydf$max_dist_eq)
mydf<-mydf[!is.na(max_dist_eq),]
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
dispersion_glmer(m.max_dist_eq)
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("MCMCglmm");library("blmeco")
install.packages("MCMglmm")
install.packages("blmeco")
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("MCMCglmm");library("blmeco")
install.packages("MCMglmm")
install.packages("MCMCglmm")
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("MCMCglmm");library("blmeco")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & !is.na(mydf$nbr_country) & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
max_dist_eq <- pmax(abs(mydf$lat_min),abs(mydf$lat_max))
mydf <- cbind(mydf,max_dist_eq)
#generating response variable
max_dist_eq_means <- tapply(mydf$max_dist_eq, mydf$pair, mean)
max_dist_eq_vars <- tapply(mydf$max_dist_eq, mydf$pair, var)
plot(max_dist_eq_vars~max_dist_eq_means)
abline(c(0,1))
obs_level <- factor(1:length(mydf$max_dist_eq))
mydf<-mydf[!is.na(max_dist_eq),]
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
dispersion_glmer(m.max_dist_eq)
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair) + (1 | obs_level), data=mydf)
PQLmax_dist_eq <- glmmPQL(data=mydf,max_dist_eq ~ mode, ~1|genus/pair, family = gaussian(link = "identity"), verbose = FALSE)
summary(PQLmax_dist_eq)
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
mydf <-within(mydf, rm("family"))
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
summary(MCMC)
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
summary(MCMC)
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
summary(MCMC)
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country >1 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 or 1 countries or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
lat_range <- mydf$lat_max-mydf$lat_min
mydf <- cbind(mydf,lat_range)
mydf$lat_range[mydf$lat_range==0] <- 0.1
#generating response variable
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus)+(1|obs_level), data=mydf,family="Gamma")
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus)), data=mydf,family="Gamma")
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus), data=mydf,family="Gamma")
dispersion_glmer(m.lat_range)
summary(m.lat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus), data=mydf,family="Gamma")
summary(m.lat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus)+(1|obs_level), data=mydf,family="Gamma")
obs_level <- factor(1:length(mydf$lat_range))
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus)+(1|obs_level), data=mydf,family="Gamma")
summary(m.lat_range)
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country >1 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 or 1 countries or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
lat_range <- mydf$lat_max-mydf$lat_min
mydf <- cbind(mydf,lat_range)
mydf$lat_range[mydf$lat_range==0] <- 0.1
#generating response variable
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
dispersion_glmer(m.lat_range)
PQLlat_range <- glmmPQL(data=mydf,lat_range ~ mode, ~1|genus/pair, family = "Gamma", verbose = FALSE)
summary(PQLlat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
overdisp <- function(model) {vpars <- function(m) {nrow(m)*(nrow(m)+1)/2}
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
summary(m.lat_range)
)
PQLlat_range <- glmmPQL(data=mydf,lat_range ~ mode, ~1|genus/pair, family = "Gamma", verbose = FALSE)
summary(PQLlat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
dispersion_glmer(m.lat_range)
summary(m.lat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
dispersion_glmer(m.lat_range)
summary(m.lat_range)
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library(car); library(MASS)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
mydf <-within(mydf, rm("family"))
mydf <-cbind(mydf,obs_level)
obs_level <- factor(1:length(mydf$lat_median))
mydf <-within(mydf, rm("family"))
mydf <-cbind(mydf,obs_level)
MCMC <- MCMCglmm(lat_median ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = T)
summary(MCMC)
PQLmedian_lat <- glmmPQL(data=mydf,lat_median ~ mode, ~1|genus/pair, family = gaussian(link = "identity"), verbose = FALSE)
summary(PQLmedian_lat)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
PQL.country <- glmmPQL(nbr_country ~ mode, ~1|genus/pair, data=mydf, family=gaussian(link='log'))
summary(PQL.country)
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("AER");library("blmeco");library("MCMCglmm")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_host_spp !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
PQL.host <- glmmPQL(nbr_host_spp ~mode, ~ 1|genus/pair, data=mydf, family=gaussian(link="log"))
summary(PQL.host)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto/")
mydf <- read.csv("auto_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$host_spp !=0,]
#remove spp with sex + asex populations, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
mydf <-within(mydf, rm("family"))
mydf <-cbind(mydf,obs_level)
MCMC <- MCMCglmm(nbr_country ~ 1 + mode, random = ~genus,
data = mydf, verbose = FALSE,prior=prior)
MCMC <- MCMCglmm(nbr_country ~ 1 + mode, random = ~genus,
data = mydf, verbose = FALSE)
summary(MCMC)
MCMC <- MCMCglmm(host_spp ~ 1 + mode, random = ~genus,
data = mydf, verbose = FALSE)
summary(MCMC)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & !is.na(mydf$nbr_country) & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
max_dist_eq <- pmax(abs(mydf$lat_min),abs(mydf$lat_max))
mydf <- cbind(mydf,max_dist_eq)
#generating response variable
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
obs_level <- factor(1:length(mydf$max_dist_eq))
mydf$pair <- as.factor(mydf$pair)
mydf<-mydf[!is.na(max_dist_eq),]
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
summary(m.max_dist_eq)
dispersion_glmer(m.max_dist_eq)
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair) + (1 | obs_level), data=mydf)
PQLmax_dist_eq <- glmmPQL(data=mydf,max_dist_eq ~ mode, ~1|genus/pair, family = gaussian(link = "identity"), verbose = FALSE)
summary(PQLmax_dist_eq)
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
mydf <-within(mydf, rm("family"))
MCMC <- MCMCglmm(max_dist_eq ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
summary(MCMC)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country >1 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 or 1 countries or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
lat_range <- mydf$lat_max-mydf$lat_min
mydf <- cbind(mydf,lat_range)
mydf$lat_range[mydf$lat_range==0] <- 0.1
#generating response variable
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
dispersion_glmer(m.lat_range)
summary(m.lat_range)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto/")
mydf <- read.csv("auto_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country >1,]
#remove spp with sex + asex populations, with 0 or 1 countries or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
lat_range <- mydf$lat_max-mydf$lat_min
mydf <- cbind(mydf,lat_range)
#generating response variable
mydf$lat_range[mydf$lat_range==0] <- 0.1
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus), data=mydf,family="Gamma")
dispersion_glmer(m.lat_range)
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus)+(1|obs_level), data=mydf,family="Gamma")
m.lat_range <- glmer(lat_range ~ mode + (1| family / genus), data=mydf,family="Gamma")
summary(m.lat_range)
PQLlat_range <- glmmPQL(data=mydf,lat_range ~ mode, ~1|family/genus, family = "Gamma", verbose = FALSE)
summary(PQLlat_range)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & !is.na(mydf$max_length) & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
body_length <- rowMeans(mydf[,5:6])
mydf <- cbind(mydf,body_length)
#Using mean of min and max length
m.length <- glmer(body_length ~ mode + (1| genus / pair), data=mydf, family=gaussian(link="log"))
dispersion_glmer(m.length)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
MCMC <- MCMCglmm(nbr_country ~ 1 + mode, random = ~genus:pair,
data = mydf, verbose = FALSE)
summary(MCMC)
# not sure about how to se
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_host_spp !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
# Comparing nbr of hosts against different distributions:
par(mfrow=c(2,2))
nbinom <- fitdistr(mydf$nbr_host_spp, "Negative Binomial")
qqp(main="Negative binomial",mydf$nbr_host_spp,
"nbinom", size = nbinom$estimate[[1]], mu = nbinom$estimate[[2]])
qqp(main="Lognormal", mydf$nbr_host_spp,"lnorm")
qqp(main="Normal", mydf$nbr_host_spp,"norm")
poisson <- fitdistr(mydf$nbr_host_spp[!is.na(mydf$nbr_host_spp)], "Poisson")
qqp(main="Poisson",mydf$nbr_host_spp, "pois", poisson$estimate)
m.host <- glmer(nbr_host_spp ~ mode + (1| genus / pair), data=mydf, family="poisson")
dispersion_glmer(modelglmer = m.host)
obs_level <- factor(1:length(mydf$nbr_host_spp))
m.host <- glmer(nbr_host_spp ~ mode + (1| genus / pair) + (1|obs_level), data=mydf, family="poisson")
summary(m.host)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
# Comparing distance from equator against different distributions:
par(mfrow=c(2,2))
gamma <- fitdistr(mydf$lat_median, "Gamma")
qqp(main="Gamma",mydf$lat_median, "gamma", shape = gamma$estimate[[1]], rate = gamma$estimate[[2]])
qqp(main="Lognormal", mydf$lat_median,"lnorm")
qqp(main="Normal", mydf$lat_median,"norm")
poisson <- fitdistr(mydf$lat_median[!is.na(mydf$lat_median)], "Poisson")
qqp(main="Poisson",mydf$lat_median, "pois", poisson$estimate)
hist(mydf$lat_median)
#crap! does not fit in any of these distributions...
m.median_lat <- glmer(log(lat_median) ~ mode + (1| genus / pair), data=mydf,family = gaussian(link="identity"))
m.median_lat <- lmer(lat_median ~ mode + (1| genus / pair)+ (1|obs_level), data=mydf)
PQLmedian_lat <- glmmPQL(data=mydf,lat_median ~ mode, ~1|genus/pair, family = gaussian(link = "identity"), verbose = FALSE)
summary(PQLmedian_lat)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto/")
mydf <- read.csv("auto_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country !=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
#generating response variable
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & !is.na(mydf$nbr_country) & mydf$nbr_country !=0 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 countries, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
max_dist_eq <- pmax(abs(mydf$lat_min),abs(mydf$lat_max))
mydf <- cbind(mydf,max_dist_eq)
#generating response variable
par(mfrow=c(2,2))
nbinom <- fitdistr(mydf$max_dist_eq[!is.na(mydf$max_dist_eq)], "Negative Binomial")
gamma <- fitdistr(mydf$max_dist_eq, "Gamma")
qqp(main="Gamma",mydf$max_dist_eq, "gamma", shape = gamma$estimate[[1]], rate = gamma$estimate[[2]])
qqp(main="Lognormal", mydf$max_dist_eq,"lnorm")
qqp(main="Normal", mydf$max_dist_eq,"norm")
poisson <- fitdistr(mydf$max_dist_eq[!is.na(mydf$max_dist_eq)], "Poisson")
qqp(main="Poisson",mydf$max_dist_eq, "pois", poisson$estimate)
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
mydf<-mydf[!is.na(max_dist_eq),]
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair), data=mydf)
dispersion_glmer(m.max_dist_eq)
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair) + (1 | obs_level), data=mydf)
obs_level <- factor(1:length(mydf$max_dist_eq))
m.max_dist_eq <- lmer(max_dist_eq ~ mode + (1| genus / pair) + (1 | obs_level), data=mydf)
PQLmax_dist_eq <- glmmPQL(data=mydf,max_dist_eq ~ mode, ~1|genus/pair, family = gaussian(link = "identity"), verbose = FALSE)
summary(PQLmax_dist_eq)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/manual/")
mydf <- read.csv("manual_processed_data.csv", header=T)
mydf <- mydf[mydf$mode !="both" & mydf$nbr_country >1 & mydf$pair!=0,]
#remove spp with sex + asex populations, with 0 or 1 countries or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
lat_range <- mydf$lat_max-mydf$lat_min
mydf <- cbind(mydf,lat_range)
mydf$lat_range[mydf$lat_range==0] <- 0.1
#generating response variable
par(mfrow=c(2,2))
mydf$lat_range[mydf$lat_range==0] <- 0.1
gamma <- fitdistr(mydf$lat_range, "Gamma")
qqp(main="Gamma",mydf$lat_range, "gamma", shape = gamma$estimate[[1]], rate = gamma$estimate[[2]])
qqp(main="Lognormal", mydf$lat_range,"lnorm")
qqp(main="Normal", mydf$lat_range,"norm")
poisson <- fitdistr(mydf$lat_range, "Poisson")
qqp(main="Poisson",mydf$lat_range, "pois", poisson$estimate)
m.lat_range <- glmer(lat_range ~ mode + (1| genus / pair), data=mydf, family = "Gamma")
dispersion_glmer(m.lat_range)
summary(m.lat_range)
