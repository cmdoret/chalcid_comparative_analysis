library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("AER");library("blmeco");library("MCMCglmm")
#MANUAL DATASET
setwd("/home/cyril/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/manual/")
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto/")
mydf <- read.csv("auto_processed_data.csv", header=T)
setwd("/home/cyril/Documents/Internship/Data/R_working_directory/auto/")
setwd("/home/cyril/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/")
mydf <- read.csv("auto_processed_data.csv", header=T)
View(mydf)
mydf <- mydf[mydf$mode !="both" & mydf$host_spp !=0,]
#remove spp with sex + asex populations, 0 hosts or not in a pair
mydf <-mydf[complete.cases(mydf[,1:4]),]
# Dropping all rows from which data was deleted (i.e. containing NA in all columns, taking the 4 first as reference)
# Comparing nbr of hosts against different distributions:
par(mfrow=c(2,2))
nbinom <- fitdistr(mydf$host_spp, "Negative Binomial")
qqp(main="Negative binomial",mydf$host_spp,
"nbinom", size = nbinom$estimate[[1]], mu = nbinom$estimate[[2]])
qqp(main="Lognormal", mydf$host_spp,"lnorm")
qqp(main="Normal", mydf$host_spp,"norm")
poisson <- fitdistr(mydf$host_spp[!is.na(mydf$host_spp)], "Poisson")
qqp(main="Poisson",mydf$host_spp, "pois", poisson$estimate)
m.host <- glmer(nbr_host_spp ~ mode + (1| genus / pair), data=mydf, family="poisson")
dispersion_glmer(modelglmer = m.host)
m.host <- glmer(nbr_host_spp ~ mode + (1| genus / pair), data=mydf, family="poisson")
library(lattice); library(multcomp); library(lme4); library(arm); library(lmerTest); library("car"); library("MASS");library("AER");library("blmeco");library("MCMCglmm")
m.host <- glmer(nbr_host_spp ~ mode + (1| genus / pair), data=mydf, family="poisson")
host_means <- tapply(mydf$host_spp, mydf$genus, mean)
host_vars <- tapply(mydf$host_spp, mydf$genus, var)
plot(host_vars~host_means)
length(levels(mydf$family))
length(levels(mydf$genus))
length(levels(mydf$species))
length(levels(mydf$species[mydf$mode=="sex"]))
length(droplevels(levels(mydf$species[mydf$mode=="sex"])))
length(mydf$species[mydf$mode=="sex"])
length(mydf$species[mydf$mode=="asex"])
length(mydf$species)
length(droplevels(levels(as.factor(mydf$gen[mydf$mode=="sex"]))))
length(droplevels(levels(factor(mydf$gen[mydf$mode=="sex"]))))
lmer(host_spp ~ mode + (1| family / genus) + (1|obs_level), data=mydf, family="poisson")
lmer(host_spp ~ mode + (1| family / genus), data=mydf, family="poisson")
glmer(host_spp ~ mode + (1| family / genus), data=mydf, family="poisson")
plot(glmer(host_spp ~ mode + (1| family / genus), data=mydf, family="poisson"))
hist(mydf$host_spp)
hist(log(mydf$host_spp))
fitdistr(mydf$host_spp[!is.na(mydf$host_spp)], "Poisson")
View(mydf)
prior = list(R = list(V = 1, n = 0, fix = 1), G = list(G1 = list(V = 1, n = 1),
G2 = list(V = 1, n = 1)))
MCMC <- MCMCglmm(host_spp ~ 1 + mode, random = ~genus,
data = mydf, verbose = FALSE)
