data$min_dist_eq <- unname(tmp_mindist)
boxplot(data$lat_range ~ mode)
boxplot(data$lat_range ~ data$mode)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
boxplot(data$min_dist_eq ~ data$mode)
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0])
par(mfrow=c(2,2))
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$max_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Min_dist: cutoff=more than 4 ref")
boxplot(data$max_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Min_dist: cutoff=more than 4 ref")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$max_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
par(mfrow=c(2,2))
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Min_dist: >4 ref")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
par(mfrow=c(2,2))
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Min_dist: >4 ref")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Max_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
par(mfrow=c(2,2))
boxplot(data$min_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Min_dist: no-cutoff")
boxplot(data$min_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Min_dist: >4 ref")
boxplot(data$max_dist_eq[data$ref>0] ~ data$mode[data$ref>0],main="Max_dist: no-cutoff")
boxplot(data$max_dist_eq[data$ref>4] ~ data$mode[data$ref>4],main="Max_dist: >4 ref")
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
data <- data0[data0$pair != 0,]
data$pair <- as.factor(data$pair)
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data$min_dist_eq <- pmin(abs(data$lat_min),abs(data$lat_max))
apply(data,MARGIN = 1,function(x){print(x)})
apply(data,MARGIN = 1,function(x){print(x[14])})
apply(data,MARGIN = 1,function(x){print(as.numeric(x[14])})
View(data)
data <- na.omit(data)
View(data)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
data <- data0[data0$pair != 0,]
data$pair <- as.factor(data$pair)
data <- data[!is.na(rownames(data)),]
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
View(data0)
View(data)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
data <- data0[data0$pair != 0,]
data$pair <- as.factor(data$pair)
data <- data[!is.na(rownames(data)),]
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data <- data[!is.na(rownames(data)),]
View(data)
View(data)
data <- data[!is.na(data$species,]
data <- data[!is.na(data$species),]
View(data)
View(data)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
View(data0)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
View(data0)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
data <- data0[data0$pair != 0,]
data$pair <- as.factor(data$pair)
data <- data[!is.na(rownames(data)),]
View(data0)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/manual/manual_processed_data.csv", header=T)
data0 <- data0[!data0$nbr_country =="0",] #remove species with no countries described
data0 <- data0[!data0$nbr_host_spp =="0",] # remove species with no hosts described
data <- data0[data0$pair != 0,]
data$pair <- as.factor(data$pair)
data <- data[!is.na(rownames(data)),]
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data <- data[!is.na(data$species),]
rownames(data) <- NULL
mindist <- function(myrow){
Min = as.numeric(myrow[14])
Max = as.numeric(myrow[16])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
#data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
data2 <- data[data$ref>2,] # remove species very few studies
data<-data2
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data <- data[(data$lat_max*data$lat_min)>0,]
data$hemi <- rep(0,nrow(data))
data$hemi[data$lat_min > 0] <- "N"
data$hemi[data$lat_max < 0] <- "S"
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
data2 <- data[data$ref>2,] # remove species very few studies
data<-data2
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data <- data[(data$lat_max*data$lat_min)>0,]
data$hemi <- rep(0,nrow(data))
data$hemi[data$lat_min > 0] <- "N"
data$hemi[data$lat_max < 0] <- "S"
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
View(data)
nrow(data[data$hemi=="N"])
nrow(data[data$hemi=="N",])
nrow(data[data$hemi=="S",])
nrow(data[data$hemi=="S" & data$mode =="asex",])
nrow(data[data$hemi=="N" & data$mode =="asex",])
data[data$hemi=="N" & data$mode =="asex",]
data[data$hemi=="S" & data$mode =="asex",]
data[data$hemi=="S" & data$mode =="asex",]
shift_max <- data$max_dist_eq[data$mode=="asex"]/data$max_dist_eq[data$mode=="sex"]
shift_min <- data$min_dist_eq[data$mode=="asex"]/data$min_dist_eq[data$mode=="sex"]
shift_range <- data$lat_range[data$mode=="asex"]/data$lat_range[data$mode=="sex"]
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])/mean(data$max_dist_eq[data$mode=="sex"])
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])/mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"])/mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"])/mean(data$lat_range[data$mode=="sex"])
shift_max
shift_min
shift_mrange
shift_range
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])- mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"]) - mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"]) - mean(data$lat_range[data$mode=="sex"])
shift_max
shift_min
shift_range
1-shift_min
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])/mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"])/mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"])/mean(data$lat_range[data$mode=="sex"])
1-shift_min
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])- mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"]) - mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"]) - mean(data$lat_range[data$mode=="sex"])
1-shift_min
shift_min
8.26*111
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])- mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"]) - mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"]) - mean(data$lat_range[data$mode=="sex"])
shift_max*111
shift_min*111
shift_range*111
shift_range
shift_range <- mean(data$lat_range[data$mode=="asex"]) - mean(data$lat_range[data$mode=="sex"])
shift_range
shift_range <- mean(data$lat_range[data$mode=="asex"])/mean(data$lat_range[data$mode=="sex"])
shift_range
sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
sensi_shift[cut,namevec[p+1]] <- mean(data[data$mode=="asex" & data$ref>cut,p])/mean(data[data$mode=="sex" & data$ref>cut,p])
}
}
sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
sensi_shift[cut,namevec[cut+1]] <- mean(data[data$mode=="asex" & data$ref>cut,p])/mean(data[data$mode=="sex" & data$ref>cut,p])
}
}
# Difference
sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
sensi_shift[(cut+1),namevec[p]] <- mean(data[data$mode=="asex" & data$ref>cut,p])/mean(data[data$mode=="sex" & data$ref>cut,p])
}
}
View(sensi_shift)
sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
sensi_shift[(cut+1),namevec[p]] <- (mean(data[data$mode=="asex" & data$ref>cut,p])-mean(data[data$mode=="sex" & data$ref>cut,p]))*111
}
}
View(sensi_shift)
plot(sensi_shift$cutoff,sensi_shift$shift_min)
plot(sensi_shift$cutoff,sensi_shift$shift_min,type="l")
points(sensi_shift$cutoff,sensi_shift$shift_max,type = "l",col="red")
points(sensi_shift$cutoff,sensi_shift$shift_range,type = "l",col="green")
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
data2 <- data[data$ref>2,] # remove species very few studies
data<-data2
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
data <- data[(data$lat_max*data$lat_min)>0,]
data$hemi <- rep(0,nrow(data))
data$hemi[data$lat_min > 0] <- "N"
data$hemi[data$lat_max < 0] <- "S"
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
# ==========================
# Only 2 asexual species are exclusively sampled in the southern hemisphere.
# Not relevant to analyze species separately for both hemispheres (2 species won't give enough info)
# Moreover, the have only been sampled once and twice, respectively.
data[data$hemi=="S" & data$mode =="asex",]
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
#data2 <- data[data$ref>2,]
#data<-data2
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
#data <- data[(data$lat_max*data$lat_min)>0,]
data$hemi <- rep(0,nrow(data))
data$hemi[data$lat_min > 0] <- "N"
data$hemi[data$lat_max < 0] <- "S"
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
rm(list=ls()); library(permute); library(nlme); library(lme4);library(parallel)
data0 <- read.csv("~/Documents/Internship/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
#data0 <- read.csv("~/Documents/Internship/chalcid_comparative_analysis/Data/R_working_directory/auto/auto_processed_data.csv", header=T)
citat <-read.csv("~/Dropbox/Cyril-Casper_shared/Internship_tidy/Data/auto/auto_citations_per_species.csv", header=T)
data <- merge(x=data0, y=citat, by.x=c("family","genus","species"), by.y=c("family","genus","species"), all=F)
data <- data[!data$nbr_country =="0",] #remove species with no countries described
data <- data[!data$host_spp =="0",] # remove species with no hosts described
#data2 <- data[data$ref>2,]
#data<-data2
data$max_dist_eq <- pmax(abs(data$lat_min),abs(data$lat_max))
#data <- data[(data$lat_max*data$lat_min)>0,]
data$hemi <- rep(0,nrow(data))
data$hemi[data$lat_min > 0] <- "N"
data$hemi[data$lat_max < 0] <- "S"
mindist <- function(myrow){
Min = as.numeric(myrow[5])
Max = as.numeric(myrow[7])
if((Max*Min) > 0){
min_dist_eq <- pmin(abs(Min),abs(Max))
} else{
min_dist_eq <- 0
}
return(min_dist_eq)
}
data$lat_range <- abs(data$lat_max-data$lat_min)
data$lat_range[data$lat_range == 0] <- 0.001
tmp_mindist<- apply(data,MARGIN = 1,FUN = mindist)
data$min_dist_eq <- unname(tmp_mindist)
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])/mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"])/mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"])/mean(data$lat_range[data$mode=="sex"])
shift_max
shift_min
shift_range
shift_max <- mean(data$max_dist_eq[data$mode=="asex"])- mean(data$max_dist_eq[data$mode=="sex"])
shift_min <- mean(data$min_dist_eq[data$mode=="asex"]) - mean(data$min_dist_eq[data$mode=="sex"])
shift_range <- mean(data$lat_range[data$mode=="asex"]) - mean(data$lat_range[data$mode=="sex"])
shift_range
shift_min
shift_max
rat_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
rat_sensi_shift[(cut+1),namevec[p]] <- mean(data[data$mode=="asex" & data$ref>cut,p])/mean(data[data$mode=="sex" & data$ref>cut,p])
}
}
# Difference (in km)
dif_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
dif_sensi_shift[(cut+1),namevec[p]] <- (mean(data[data$mode=="asex" & data$ref>cut,p])-mean(data[data$mode=="sex" & data$ref>cut,p]))*111
}
}
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
29*111
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3300))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,33300))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,5000))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
rat_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
rat_sensi_shift[(cut+1),namevec[p]] <- median(data[data$mode=="asex" & data$ref>cut,p])/median(data[data$mode=="sex" & data$ref>cut,p])
}
}
# Difference (in km)
dif_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
dif_sensi_shift[(cut+1),namevec[p]] <- (median(data[data$mode=="asex" & data$ref>cut,p])-median(data[data$mode=="sex" & data$ref>cut,p]))*111
}
}
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,5000))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
rat_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
rat_sensi_shift[(cut+1),namevec[p]] <- mean(data[data$mode=="asex" & data$ref>cut,p])/mean(data[data$mode=="sex" & data$ref>cut,p])
}
}
# Difference (in km)
dif_sensi_shift <- data.frame(cutoff=seq(0,20))
namevec <- c(min_dist_eq="shift_min",max_dist_eq="shift_max",lat_range="shift_range")
for(cut in 0:20){
for(p in c("min_dist_eq","max_dist_eq","lat_range")){
dif_sensi_shift[(cut+1),namevec[p]] <- (mean(data[data$mode=="asex" & data$ref>cut,p])-mean(data[data$mode=="sex" & data$ref>cut,p]))*111
}
}
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3))
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000))
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
View(rat_sensi_shift)
legend("bottomright",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
legend("bottomright",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000),ylab="km difference of mean asex-sex")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
legend("bottomright",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
legend("bottomleft",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000),ylab="km difference of mean asex-sex")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
legend("bottomleft",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_max,type = "l",col="red")
points(rat_sensi_shift$cutoff,rat_sensi_shift$shift_range,type = "l",col="green")
legend("bottomleft",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000),ylab="km difference of mean asex-sex")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_max,type = "l",col="red")
points(dif_sensi_shift$cutoff,dif_sensi_shift$shift_range,type = "l",col="green")
legend("bottomleft",legend=c("min distance from equator","max distance from equator","latitude range"),fill = c("blue","red","green"))
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
plot(dif_sensi_shift$cutoff,dif_sensi_shift$shift_min,type="l",col="blue",ylim=c(-5000,5000),ylab="km difference of mean asex-sex")
par(mfrow=c(1,2))
plot(rat_sensi_shift$cutoff,rat_sensi_shift$shift_min,type="l",col="blue",ylim=c(0,3),xlab="reference cutoff",ylab="ratio of mean asex/sex")
